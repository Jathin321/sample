<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>final List</title>
    <link rel="stylesheet" href="bootstrap.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
    <nav class="navbar bg-primary" data-bs-theme="dark">
        <a class="navbar-brand ps-4 fs-2" style="font-family: Verdana, Geneva, Tahoma, sans-serif;">College Guide</a>
    </nav>
    <div class="container w-75 col-md-5 col-sm-6 border border-secondary mt-5"
        style="height: 535px; overflow-y: scroll;" id="clgs">
        <table class="table" id="table">
            <thead>
                <tr>
                    <th scope="col">College Name</th>
                    <th scope="col">Code</th>
                    <th scope="col">Location</th>
                    <th scope="col">Branch</th>
                    <th scope="col">Close Rank</th>
                </tr>
            </thead>
            <tbody id="tbody">

            </tbody>
        </table>
    </div>
    <div class=" w-75 mx-auto">
        <button type="button" class="btn btn-secondary mt-3 mb-4" style="width: 200px;" onclick="back()">Back</button>
        <button href="" type="button" class="btn btn-primary mt-3 mb-4" style="width: 200px;" id="download">Download</button>
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
        <script>
            // Get references to the content div and the download button
            const contentDiv = document.getElementById('content');
            const downloadButton = document.getElementById('downloadButton');
        
            // Add a click event listener to the button
            downloadButton.addEventListener('click', () => {
                // Use html2pdf to generate the PDF
                html2pdf()
                    .from(contentDiv)
                    .set({ margin: 10, filename: 'downloaded_content.pdf', div: { type: 'jpeg', quality: 0.98 } })
                    .outputPdf()
                    .then(pdf => {
                        // Trigger the download of the PDF
                        const blob = new Blob([pdf], { type: 'application/pdf' });
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = 'downloaded_content.pdf';
                        a.style.display = 'none';
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                    });
            });
        </script> -->
    </div>
    <script>
        function back() {
            window.history.back();
        }
        var final_list = sessionStorage.getItem('final_list');
        var tbody = document.getElementById('tbody');
        let div = document.createElement('div');
        div.innerHTML = final_list;
        if(div.firstElementChild.tagName == 'DIV')
        {
            // var thead = document.getElementById('table');
            // console.log(thead);
            // thead.removeChild(thead.firstElementChild);
            tbody.innerHTML = ` <tr><td colspan="5"><div class="alert alert-danger" role="alert">
    <h4 class="alert-heading">Oops!</h4>
    <p>Looks like you have forgot to save you colleges list or you have not added any colleges to you list, please go back and add colleges to your list and dont forget to save before you proceed.</p>
    <hr>
    <p class="mb-0">Sorry for the inconvinience, we are working on auto save feature, Soon we will update the website.</p>
  </div></td></tr> `;
        }
        else{
            tbody.innerHTML = final_list;
        var but = tbody.getElementsByTagName('tr');
        for (let i = 0; i < but.length; i++) {
            var remove_button = but[i].lastElementChild;
            but[i].removeChild(remove_button);

        }
        for (let i = 0; i < but.length; i++) {
            if(tbody.firstElementChild){
            var clg_name = but[i].getElementsByTagName('th')[0].firstElementChild;
            var name_th = document.createElement('th');
            name_th.textContent = clg_name.title;
            // console.log(name_th.textContent);
            but[i].prepend(name_th);
            but[i].getElementsByTagName('th')[0].style.fontWeight = 500;
            but[i].getElementsByTagName('th')[1].style.fontWeight = 400;}
        }
    }
    </script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/printThis/1.15.0/printThis.js"></script>
  <script>
    $(document).ready(function(){
    $('print').click(function()
    {
        $('#clgs').printThis();
    });
} );
  </script> -->

  <script>

    let print = document.querySelector("#clgs");
    
    let btn = document.querySelector("#download");
     btn.addEventListener('click', ()=>{ html2pdf().from(print).save()})
  </script>

</body>

    <!-- <script src="http://raw.githack.com/eKoopmans/html2pdf/master/dist/html2pdf.bundle.js"></script>
    <script>
        function generatepdf()
        {
            const element = document.getElementById('clgs');
            html2pdf(element);
        }
    </script> -->

</html>

<!-- <div class="alert alert-success" role="alert">
    <h4 class="alert-heading">Well done!</h4>
    <p>Aww yeah, you successfully read this important alert message. This example text is going to run a bit longer so that you can see how spacing within an alert works with this kind of content.</p>
    <hr>
    <p class="mb-0">Whenever you need to, be sure to use margin utilities to keep things nice and tidy.</p>
  </div> -->